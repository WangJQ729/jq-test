name: 合伙人列表
story: partners
#enable: false
#dataProvider:
#  - partner_email: gerow1736514021927@gmx.com
beforeClass:
  name: 登录合伙人后台
  step:
    - keyWord: 登录partners
    - keyWord: 获取合伙人信息
    - keyWord: 获取合伙人邀请码
    - keyWord: 获取合伙人返佣比例
testMethod:
  - name: 快捷注册
    step:
      - keyWord: 快捷注册-合伙人邀请码-随机邮箱
      - keyWord: 增加合约账户资产
  - name: 快捷注册-升级合伙人
    step:
      - keyWord: 快捷注册-合伙人邀请码-随机邮箱
      - keyWord: 增加合约账户资产
      - keyWord: 升级为合伙人
        dataProvider:
          - futureRatio: ${__Random(0,${totalFutureRatio})}
            exchangeRatio: ${__Random(0,${totalExchangeRatio})}
  - name: 添加合伙人
    invocationCount: 1
    dataProvider:
      - bd_uid: 126
    step:
#      - keyWord: 获取BD列表
      #      - keyWord: BD统计
      - keyWord: 快捷注册
      #      - keyWord: BD统计-团队人数不变
      - keyWord: 获取用户信息
      - keyWord: 新增合伙人
      - keyWord: 增加合约账户资产
  - name: 更改BD
    enable: false
    step:
      - keyWord: BD统计-校验新增合伙人
      - keyWord: 登录partners-新合伙人
      - keyWord: 获取合伙人信息
      - keyWord: 获取合伙人邀请码
      - keyWord: 获取本月交易额
      #      - keyWord: 代理商后台返佣发放
      - keyWord: 快捷注册-合伙人邀请码-随机邮箱
      - keyWord: BD统计-用户合伙人邀请码注册
      - keyWord: 获取用户信息和上级代理uid
      - keyWord: BD合伙人列表
      - keyWord: 增加合约账户资产
      - keyWord: 通过uid获取用户token
      - keyWord: 市价开仓
      - keyWord: 持有仓位信息
      - keyWord: U本位合约历史委托
      #      - keyWord: 代理商后台返佣发放
      - keyWord: 直客佣金查询-首单
        assertion:
          - json:
              $.result.items[0].takerFee: ${openDealFee}
              $.result.items[0].takerRebate: ${__groovy(${openDealFee} * ${futureSelfRatio} / 100)}
            assertionType: EIGHTDECIMALPLACES
      - keyWord: 佣金发放明细
      - keyWord: 获取本月交易额-校验交易额
      - keyWord: BD统计-开仓
      - keyWord: 获取团队佣金
        assertion:
          - json:
              $.result.items[0].totalCommission: ${__groovy(${openDealFee} * ${bdFutureRatio} / 100)}
            assertionType: EIGHTDECIMALPLACES
      - keyWord: 市价平仓
      - keyWord: U本位合约历史委托-平仓
      #      - keyWord: 代理商后台返佣发放
      - keyWord: 直客佣金查询-平仓
        assertion:
          - json:
              $.result.items[0].takerFee: ${__groovy(${takerFee} + ${closeDealFee})}
              $.result.items[0].takerRebate: ${__groovy(${takerRebate} + ${closeDealFee} * ${futureSelfRatio} / 100)}
            assertionType: EIGHTDECIMALPLACES
      - keyWord: 佣金发放明细
      - keyWord: 获取本月交易额-校验交易额
      - keyWord: 历史成交查询-平仓
      - keyWord: 获取团队佣金
        assertion:
          - json:
              $.result.items[0].totalCommission: ${__groovy(${totalCommission} + ${closeDealFee} * ${bdFutureRatio} / 100)}
            assertionType: EIGHTDECIMALPLACES
      #      - keyWord: 代理商后台返佣发放
      - keyWord: BD统计-平仓
#      - keyWord: 变更BD
#      - keyWord: BD统计