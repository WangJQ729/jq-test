keyWord:
  step:
    - name: 现货市价买入
      url: /web/api/v1/order/place_order
      sleep: 2000
      headers:
        Token: ${token}
      method: POST
      body: |
        {"side":"2","price":0,"volume":"99","base":"${spotSymbol}","quote":"USDT","type":"2"}
      assertion: [json: {$.code: '0'}]
    - name: web现货历史委托
      url: /web/api/v1/order/history/page
      headers:
        Token: ${token}
      method: POST
      sleep: 1000
      body: |
        {
            "page": 1,
            "pageSize": 10,
            "side": null,
            "base": "${spotSymbol}",
            "quote": null,
            "type": null,
            "status": null,
            "startTime": "${__PlusDay(yyyy-MM-dd,-1,)}T16:00:00.000Z",
            "endTime": "${__PlusDay(yyyy-MM-dd,1,)}T16:00:00.000Z"
        }
      extractor:
        - json:
            webFee: $.data.data[0].fee
            dealAmount: $.data.data[0].dealAmount
            orderId: $.data.data[0].orderId
      assertion:
        - json:
            $.code: '0'
        - json:
            $.data.data[0].dealAmount: 5
          assertionType: GREATEROREQUALTO
    - name: 社区活动报名
      url: /web/trade/match/enroll
      headers:
        Token: ${token}
      method: POST
      body: |
        {"actId":${actId}}
      assertion: [json: {$.code: '0'}]
    - keyWord: 社区活动报名
      name: 社区活动报名-检验报名结果
      headers:
        Token: ${token}
        Accept-Language: ${Accept-Language}
      assertion:
        - json:
            $.code: '${code}'
            $.msg: ${msg}
        - json:
            $.msg: ${msgKey}
          assertionType: NOT
    - name: 获取汇率
      url: /web/api/v1/common/rate/list
      method: GET
      extractor:
        - json:
            rate: $.data[?(@.baseSymbol=='BTC' && @.quoteSymbol=='USDT')].rate
          site: TESTSUITE
      assertion: [ json: { $.code: '0' } ]
    - name: 统计活动数据
      sleep: 1000
      url: /welfare/inner/bonus/activity/userRecord
      method: GET
    #      assertion: [ json: { $.code: '0' } ]
    - name: 活动报名
      url: /welfare/bonus/activity/goal/register
      headers:
        Token: ${token}
      method: POST
      body: |
        {"actId":${actId}}
      assertion: [ json: { $.code: '0' } ]
    - name: 活动报名-校验报名结果
      keyWord: 活动报名
      headers:
        Accept-Language: ${Accept-Language}
        Token: ${token}
      assertion:
        - json:
            $.code: '${code}'
            $.msg: ${msg}
        - json:
            $.msg: ${msgKey}
          assertionType: NOT
    - name:  活动信息-活动不存在
      url: /welfare/bonus/activity/goal/info
      method: GET
      variables:
        actCode: ${actCode}
      assertion:
        - json:
            $.code: '90001'
            $.msg: Events don't exist
    - keyWord: 活动信息-活动不存在
      name: 活动信息
      extractor:
        - json:
            actStatus: $.data.actStatus
            color: $.data.color
            minBalance: $.data.minBalance
            actStartTime: $.data.actStartTime
            actEndTime: $.data.actEndTime
            actEnrollStartTime: $.data.actEnrollStartTime
            actEnrollEndTime: $.data.actEnrollEndTime
            firstRuleName: $.data.firstRuleName
      assertion: [ json: { $.code: '0' } ]
    - name: 获取记录
      url: /welfare/bonus/activity/goal/user/record
      headers:
        Token: ${token}
      method: GET
      variables:
        actId: ${actId}
      extractor:
        - json:
            ruleId: $.data.realValue[0].ruleId
            realValue: $.data.realValue[0].realValue
      assertion: [json: {$.code: '0'}]
    - name: 领取记录-进度为零
      keyWord: 获取记录
      assertion:
        - json:
            $.data.realValue[0].realValue: '0'
            $.code: '0'
    - name: 领取奖励
      url: /welfare/bonus/activity/goal/claim/coupon
      headers:
        Token: ${token}
      method: GET
      variables:
        actId: ${actId}
        ruleId: ${ruleId}
      assertion:
        - json:
            $.code: '0'
            $.data.bonus: '${awardAmt}'
    - keyWord: 领取奖励
      name: 领取奖励-多次尝试
      untilWait: 10
    - keyWord: 领取奖励
      name: 领取奖励-校验领取结果
      headers:
        Token: ${token}
        Accept-Language: ${Accept-Language}
      assertion:
        - json:
            $.code: '${code}'
            $.msg: ${msg}
    - name: 奖励记录
      url: /welfare/bonus/activity/goal/coupon/list
      headers:
        Token: ${token}
      method: GET
      variables:
        actId: ${actId}
      assertion:
        - json:
            $.code: '0'
            $.data[0].task: ${firstRuleName}
            $.data[0].bonus: '${awardAmt}'
            $.data[0].transactionType: 'FUTURES'
            $.data[0].type: 'EXPERIENCE'
    - name: 生成邀请链接
      url: /web/api/welfare/rebate/generate_link_code
      headers:
        Token: ${token}
      method: POST
      body: |
        {"shareRatio":${__groovy(${__Random(0,20)}/100,shareRatio)},"myRatio":${__groovy(0.2-${shareRatio},)},"defaultSelect":1,"remark":""}
      assertion: [ json: { $.code: '0' } ]
    - name: 合约体验金券列表
      url: /welfare/welfare_coupon/page
      headers:
        Token: ${token}
      method: GET
      variables:
        current: 1
        size: 10
        couponType: experience
      assertion: [ json: { $.code: '0' } ]
      extractor:
        - json:
            coupon_id: $.data.records[0].id
    - name: 激活体验金券
      url: /welfare/welfare_coupon/activate_coupon
      headers:
        Token: ${token}
      method: POST
      body: |
        {"couponId":${coupon_id}}
      assertion: [json: {$.code: '0'}]
    - name: 邀请链接列表
      url: /web/api/welfare/rebate/link_list
      untilWait: 10
      headers:
        Token: ${token}
      method: GET
      assertion: [ json: { $.code: '0' } ]
      extractor:
        - json:
            link_code: $.data[?(@.defaultSelect==1)].code
    - name: 我的邀请链接
      url: /web/api/welfare/rebate/get_count
      headers:
        Token: ${token}
      method: GET
      assertion: [ json: { $.code: '0' } ]
    - name: 推荐记录
      url: /web/api/welfare/rebate/share_list
      variables:
        startDate: ${__PlusDay(yyyy-MM-dd,-6,)}T00:00:00Z
        endDate: ${__PlusDay(yyyy-MM-dd,1,)}T00:00:00Z
        pageSize: 10
        pageNo: 1
      headers:
        Token: ${token}
      method: GET
      assertion: [ json: { $.code: '0' } ]
    - name: 返佣记录
      url: /web/api/welfare/rebate/rebate_list
      variables:
        startDate: ${__PlusDay(yyyy-MM-dd,-6,)}T00:00:00Z
        endDate: ${__PlusDay(yyyy-MM-dd,1,)}T00:00:00Z
        pageSize: 10
        pageNo: 1
      headers:
        Token: ${token}
      method: GET
      assertion: [ json: { $.code: '0' } ]
    - name: 我的返佣比例
      url: /web/api/welfare/rebate/invite_rank
      headers:
        Token: ${token}
      method: GET
      assertion: [ json: { $.code: '0' } ]
    - name: 获取默认邀请链接
      url: /web/api/welfare/rebate/get_default_invite
      headers:
        Token: ${token}
      method: GET
      assertion: [ json: { $.code: '0' } ]
      extractor:
        - json:
            link_code: $.data.inviteCode
    - name: 抽奖类活动报名
      url: /welfare/lucky/draw/activity/register
      headers:
        Token: ${token}
      method: POST
      body: |
        {"actId":${actId}}
      assertion: [ json: { $.code: '0' } ]
    - name: 抽奖类任务进度
      untilWait: 120
      url: /welfare/lucky/draw/activity/user/task/record
      variables:
        actId: ${actId}
      headers:
        Token: ${token}
      method: GET
      assertion:
        - json:
            $.data.userTaskRecordList.userTaskRecord.invitedUserRegisterNum[0]: 1
    - name: 抽奖类活动抽奖
      url: /welfare/lucky/draw/activity/prize/draw
      headers:
        Token: ${token}
      method: POST
      body: |
        {"actId":${actId}}
      extractor:
        - json:
            prizeType: $.data.prizeType
      assertion: [ json: { $.code: '0' } ]
    - name: 抽奖类活动获奖记录
      url: /welfare/lucky/draw/activity/user/win-prize-record/list
      variables:
        actId: ${actId}
      headers:
        Token: ${token}
      method: GET
      assertion:
        - json:
            $.code: '0'
            $.data.recordList[0].prizeType: ${prizeType}