keyWord:
  step:
    - name: 现货市价买入
      url: /web/api/v1/order/place_order
      sleep: 2000
      headers:
        Token: ${token}
      method: POST
      body: |
        {"side":"2","price":0,"volume":"99","base":"${spotSymbol}","quote":"USDT","type":"2"}
      assertion: [json: {$.code: '0'}]
    - name: web现货历史委托
      url: /web/api/v1/order/history/page
      headers:
        Token: ${token}
      method: POST
      sleep: 1000
      body: |
        {
            "page": 1,
            "pageSize": 10,
            "side": null,
            "base": "${spotSymbol}",
            "quote": null,
            "type": null,
            "status": null,
            "startTime": "${__PlusDay(yyyy-MM-dd,-1,)}T16:00:00.000Z",
            "endTime": "${__PlusDay(yyyy-MM-dd,1,)}T16:00:00.000Z"
        }
      extractor:
        - json:
            webFee: $.data.data[0].fee
            dealAmount: $.data.data[0].dealAmount
            orderId: $.data.data[0].orderId
      assertion:
        - json:
            $.code: '0'
        - json:
            $.data.data[0].dealAmount: 5
          assertionType: GREATEROREQUALTO
    - name: 社区活动报名
      url: /web/trade/match/enroll
      headers:
        Token: ${token}
      method: POST
      body: |
        {"actId":${actId}}
      assertion: [json: {$.code: '0'}]
    - keyWord: 社区活动报名
      name: 社区活动报名-检验报名结果
      headers:
        Token: ${token}
        Accept-Language: ${Accept-Language}
      assertion:
        - json:
            $.code: '${code}'
            $.msg: ${msg}
        - json:
            $.msg: ${msgKey}
          assertionType: NOT
    - name: 获取汇率
      url: /web/api/v1/common/rate/list
      method: GET
      extractor:
        - json:
            rate: $.data[?(@.baseSymbol=='BTC' && @.quoteSymbol=='USDT')].rate
          site: TESTSUITE
      assertion: [ json: { $.code: '0' } ]
    - name: 统计活动数据
      sleep: 1000
      url: /welfare/inner/bonus/activity/userRecord
      method: GET
    #      assertion: [ json: { $.code: '0' } ]
    - name: 活动报名
      url: /welfare/bonus/activity/goal/register
      headers:
        Token: ${token}
      method: POST
      body: |
        {"actId":${actId}}
      assertion: [ json: { $.code: '0' } ]
    - name: 活动报名-校验报名结果
      keyWord: 活动报名
      headers:
        Accept-Language: ${Accept-Language}
        Token: ${token}
      assertion:
        - json:
            $.code: '${code}'
            $.msg: ${msg}
        - json:
            $.msg: ${msgKey}
          assertionType: NOT
    - name:  活动信息-活动不存在
      url: /welfare/bonus/activity/goal/info
      method: GET
      variables:
        actCode: ${actCode}
      assertion:
        - json:
            $.code: '90001'
            $.msg: Events don't exist
    - keyWord: 活动信息-活动不存在
      name: 活动信息
      extractor:
        - json:
            actStatus: $.data.actStatus
            color: $.data.color
            minBalance: $.data.minBalance
            actStartTime: $.data.actStartTime
            actEndTime: $.data.actEndTime
            actEnrollStartTime: $.data.actEnrollStartTime
            actEnrollEndTime: $.data.actEnrollEndTime
            firstRuleName: $.data.firstRuleName
      assertion: [ json: { $.code: '0' } ]
    - name: 获取记录
      url: /welfare/bonus/activity/goal/user/record
      headers:
        Token: ${token}
      method: GET
      variables:
        actId: ${actId}
      extractor:
        - json:
            ruleId: $.data.realValue[0].ruleId
            realValue: $.data.realValue[0].realValue
      assertion: [json: {$.code: '0'}]
    - name: 领取记录-进度为零
      keyWord: 获取记录
      assertion:
        - json:
            $.data.realValue[0].realValue: '0'
            $.code: '0'
    - name: 领取奖励
      url: /welfare/bonus/activity/goal/claim/coupon
      headers:
        Token: ${token}
      method: GET
      variables:
        actId: ${actId}
        ruleId: ${ruleId}
      assertion:
        - json:
            $.code: '0'
            $.data.bonus: '${awardAmt}'
    - keyWord: 领取奖励
      name: 领取奖励-多次尝试
      untilWait: 10
    - keyWord: 领取奖励
      name: 领取奖励-校验领取结果
      headers:
        Token: ${token}
        Accept-Language: ${Accept-Language}
      assertion:
        - json:
            $.code: '${code}'
            $.msg: ${msg}
    - name: 奖励记录
      url: /welfare/bonus/activity/goal/coupon/list
      headers:
        Token: ${token}
      method: GET
      variables:
        actId: ${actId}
      assertion:
        - json:
            $.code: '0'
            $.data[0].task: ${firstRuleName}
            $.data[0].bonus: '${awardAmt}'
            $.data[0].transactionType: 'FUTURES'
            $.data[0].type: 'EXPERIENCE'
